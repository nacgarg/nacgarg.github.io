<html>

<head>
    <title>
        Fractal Animation | Nachi Gargi
    </title>
</head>

<body>
    <canvas width='5000px' height=5000px id='asdf'>
    </canvas>
    <img src='' id='img' />
    <script>
    var ctx = document.getElementById('asdf').getContext("2d");
    ctx.fillStyle = "#000000";

    function drawTriangle(x, y, s, orientation, color) {

        if (orientation == 'up') {
            ctx.moveTo(x, (y + ((s / 2) * Math.sqrt(3))));
            ctx.beginPath();
            ctx.lineTo(x, (y + ((s / 2) * Math.sqrt(3))));
            ctx.lineTo(x + (s / 2), y);
            ctx.lineTo(x + s, y + ((s / 2) * Math.sqrt(3)))
            ctx.lineTo(x, (y + ((s / 2) * Math.sqrt(3))));
            if (color) {
                ctx.fillStyle = color;
                ctx.fill()
            } else {
                ctx.stroke();
            }

        } else {
            ctx.moveTo(x, y);
            ctx.beginPath();
            ctx.lineTo(x + (s / 2), y + ((s / 2) * Math.sqrt(3)));
            ctx.lineTo(x + s, y);
            ctx.lineTo(x, y);
            ctx.lineTo(x + (s / 2), y + ((s / 2) * Math.sqrt(3)));
            if (color) {
                ctx.fillStyle = color;
                ctx.fill()
            } else {
                ctx.stroke();
            }
        }

    }

    function drawIteration(x, y, s, orientation, n, max) {
        setTimeout(function() {
            if (n <= max) {
                var colors = ['#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF']
                if (orientation == 'up') {
                    
                    drawTriangle(x, y, s, orientation); //draw big triangle
                    drawIteration(x + (s / 2) - (s / 6), y + ((1 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'down', n + 1, max); //draw top triangle in hexagon
                    drawIteration(x + (s / 2) - (s / 6), y + ((2 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'up', n + 1, max); //draw bottom triangle in hexagon
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6), y + ((1 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'up', n + 1, max); //draw top-left triangle
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6) + (s / 2) - (s / 6), y + ((1 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'up', n + 1, max); //draw top-right triangle
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6) + (s / 2) - (s / 6), y + ((2 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'down', n + 1, max); //draw bottom-right triangle
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6) + (s / 2)  - (s / 2) , y + ((2 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'down', n + 1, max); //draw bottom-left triangle
                } else {
                    drawTriangle(x, y, s, orientation); //draw big triangle
                    
                    drawIteration(x + (s / 2) - (s / 6), y + ((1 / 3) * s / 2 * Math.sqrt(3)) - 1 / 3 * s / 2 * Math.sqrt(3), s / 3, 'down', n + 1, max); //draw top triangle in hexagon
                    drawIteration(x + (s / 2) - (s / 6), y + ((2 / 3) * s / 2 * Math.sqrt(3)) - 1 / 3 * s / 2 * Math.sqrt(3), s / 3, 'up', n + 1, max); //draw bottom triangle in hexagon
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6), y + ((1 / 3) * s / 2 * Math.sqrt(3)) - 1 / 3 * s / 2 * Math.sqrt(3), s / 3, 'up', n + 1, max); //draw top-left triangle
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6) + (s / 2) - (s / 6), y + ((1 / 3) * s / 2 * Math.sqrt(3)) - 1 / 3 * s / 2 * Math.sqrt(3), s / 3, 'up', n + 1, max); //draw top-right triangle
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6) + (s / 2) - (s / 6), y + ((2 / 3) * s / 2 * Math.sqrt(3)) - 1 / 3 * s / 2 * Math.sqrt(3), s / 3, 'down', n + 1, max); //draw bottom-right triangle
                    drawIteration(x + (s / 2) - (s / 6) - (s / 6), y + ((2 / 3) * s / 2 * Math.sqrt(3)) - 1 / 3 * s / 2 * Math.sqrt(3), s / 3, 'down', n + 1, max); //draw bottom-left triangle}
                }
            }
        }, 1000);
        setTimeout(function() {
            if (n <= max) {
                var colors = ['#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF', '#FF0000', '#00FF00', '#0000FF']
                if (orientation == 'up') {
                    drawTriangle(x, y + ((2 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'up', colors[n]);
                    drawTriangle(x + s / 2 + s / 6, y + ((2 / 3) * s / 2 * Math.sqrt(3)), s / 3, 'up', colors[n]);
                    drawTriangle(x + s / 2 - s / 6, y, s / 3, 'up', colors[n]);
                } else {

                    drawTriangle(x, y, s / 3, 'down', colors[n]);
                    drawTriangle(x + s / 2 + s / 6, y, s / 3, 'down', colors[n]);
                    drawTriangle(x + s / 2 - s / 6, y + s / 2 * Math.sqrt(3) - s / 6 * Math.sqrt(3), s / 3, 'down', colors[n]);
                }
            }
        }, 2000);
    }

    function iterate(x, y, s, orientation, n) {
        if (n < 50) {
            drawTriangle(x, y, s, orientation);
        }

        iterate((x + (s / 2)) - (s / 6), (y + (s / 2) * Math.sqrt(3)) - (s / 6) * Math.sqrt(3), s / 3, 'up', n + 1);
        iterate(x, (y + (s / 2) * Math.sqrt(3)) - (s / 6) * Math.sqrt(3), s / 3, 'up', n + 1);
        iterate((x + s) - s / 3, (y + (s / 2) * Math.sqrt(3)) - (s / 6) * Math.sqrt(3), s / 3, 'up', n + 1);
    }

    var maxn = parseInt(prompt('Number of iterations: Hit enter without typing anything for the default')) || 7;
    //drawTriangle(0, 0, 1000, 'up');
    drawIteration(0, 0, 5000, 'up', 1, maxn)
        //drawIteration(0, 0, 500, 'up');
        /*var c = document.getElementById('asdf');
        var url = c.get(0).toDataUrl();
        document.getElementById('img').src=url*/
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57631534-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
